# 最少知识原则

最少知识原则（LKP）说的是一个软件实体应当尽可能少地与其他实体发生相互作用。这里的软件实体是一个广义的概念，不仅包括对象，还包括系统、类、模块、函数、变量等。

## 减少对象之间的联系

**单一职责原则**指导我们把对象划分成较小的粒度，这可以**提高对象的可复用性**。**但越来越多的对象之间可能会产生错综复杂的联系**，如果修改了其中一个对象，很可能会影响到跟它相互引用的其他对象。对象和对象耦合在一起，有可能会降低它们的可复用性。

最少知识原则要求我们在设计程序时，应当尽量减少对象之间的交互。如果两个对象之间不必彼此直接通信，那么这两个对象就不要发生直接的相互联系。常见的做法是**引入一个第三者对象，来承担这些对象之间的通信作用**。如果一些对象需要向另一些对象发起请求，可以**通过第三者对象来转发这些请求**。

## 设计模式中的LKP

### 中介者模式

中介者模式很好地体现了最少知识原则。通过增加一个中介者对象，让所有的相关对象都通过中介者对象来通信，而不是互相引用。所以，当一个对象发生改变时，只需要通知中介者对象即可。

### 外观模式

外观模式的作用是对客户屏蔽一组子系统的复杂性。

**外观模式对客户提供一个简单易用的高层接口，高层接口会把客户的请求转发给子系统来完成具体的功能实现。** 

但在一段使用了外观模式的程序中，**请求外观并不是强制的**。如果外观不能满足客户的个性化需求，那么客户**也可以选择越过外观来直接访问子系统**。

外观模式的关键是定义一个高层接口去封装一组“子系统”。

外观模式的作用主要有两点：
❏ 为一组子系统提供一个简单便利的访问入口。
❏ 隔离客户与复杂子系统之间的联系，客户不用去了解子系统的细节。

从第二点来，外观模式是符合最少知识原则的。

## 封装在最少知识原则中的体现

对象之间难免产生联系，当一个对象必须引用另外一个对象的时候，我们可以让对象只暴露必要的接口，让对象之间的联系限制在最小的范围之内。

把变量的可见性限制在一个尽可能小的范围内，这个变量对其他不相关模块的影响就越小，变量被改写和发生冲突的机会也越小。这也是广义的最少知识原则的一种体现。

虽然遵守最小知识原则减少了对象之间的依赖，但也有可能增加一些庞大到难以维护的第三者对象。跟单一职责原则一样，在实际开发中，是否选择让代码符合最少知识原则，要根据具体的环境来定。